# 084 - There are two types of characters（★3）

## テーマ: ランレングス圧縮

## 解法

"o と x が両方含まれている区間 $[l,r]$ の個数" を求めるのは難しいので, 以下の余事象を考える.

"o のみを含む区間", "x のみを含む区間"　の合計個数 $ret$ を求めよ.

そこで, 区間 $[l, r]$ の選び方の数は, $r = 1$ のとき 1 通り, $r = 2$ のとき 2 通り,..., $r = N$ のとき $N$ 通りとなるので

$$
1 + 2 + \cdots + N = \frac{N(N+1)}{2}
$$

で求められる.

したがって, 求めるべき答えは $N(N+1)/2 - ret$ となるため, $ret$ が求められれば良い.

$ret$ を求めるために, 文字列 $S$ を**ランレングス圧縮** することを考える. 例えば $S = $ "oooooxxxxooo" の場合, $(c_i, d_i) = ("o", 5),("x", 4),("o", 3)$ と圧縮される.

「区間 $[l, r] が o と x$ のうち片方しか含まないこと」は「区間 $(l, r)$ が単一のグループのみに入っていること」と言い換えられる. そこで, グループ $i$ のみに入っている区間の個数は

$$
1 + 2 + \cdots + d_i = \frac{d_i(d_i + 1)}{2}
$$

であるため,

$$
ret = d_1(d_1 + 1)/2 + d_2(d_2 + 1)/2 + \cdots + d_K(d_K + 1) / 2
$$

であるとわかる.
